
<telerik:RadGrid ID="RGInvestigations" runat="server" CellSpacing="0" GridLines="None" AllowAutomaticDeletes="True" AllowAutomaticInserts="True" AutoGenerateDeleteColumn="True" DataSourceID="SqlDSInvestigation" AllowPaging="True" OnItemInserted="RGInvestigations_ItemInserted" PageSize="5">
                                            <MasterTableView AutoGenerateColumns="False" CommandItemDisplay="Top" DataSourceID="SqlDSInvestigation" DataKeyNames="VisitID,InvestigationCode">
                                                <RowIndicatorColumn Visible="False">
                                                </RowIndicatorColumn>
                                                <Columns>
                                                    <telerik:GridBoundColumn DataField="VisitID" FilterControlAltText="Filter VisitID column" HeaderText="VisitID" ReadOnly="True" SortExpression="VisitID" UniqueName="VisitID">
                                                    </telerik:GridBoundColumn>

                                                    <telerik:GridDropDownColumn DataSourceID="SqlDSlkp_Investigations" Display="False" ColumnEditorID="GridDropDownListColumnEditor"
                                                        FilterControlAltText="Filter ddInvestigationCode column" HeaderText="Investigation Code"
                                                        ListTextField="Investigation" ListValueField="InvestigationCode" UniqueName="ddInvestigationCode" DataField="InvestigationCode"
                                                        AllowAutomaticLoadOnDemand="False" Resizable="False">

                                                        <ColumnValidationSettings EnableRequiredFieldValidation="True"
                                                            RenderValidatorBeforeEditor="True">
                                                            <RequiredFieldValidator SetFocusOnError="True" ForeColor="Red">*</RequiredFieldValidator>
                                                        </ColumnValidationSettings>
                                                    </telerik:GridDropDownColumn>

                                                    <telerik:GridBoundColumn DataField="InvestigationCode" DataType="System.Int16" Display="False" FilterControlAltText="Filter InvestigationCode column" HeaderText="IC" ReadOnly="True" SortExpression="InvestigationCode" UniqueName="InvestigationCode">
                                                    </telerik:GridBoundColumn>

                                                    <telerik:GridBoundColumn DataField="Investigation" FilterControlAltText="Filter Investigation column" HeaderText="Investigation Des" ReadOnly="True" SortExpression="Investigation" UniqueName="Investigation">
                                                    </telerik:GridBoundColumn>
                                                </Columns>
                                            </MasterTableView>
                                            <PagerStyle Mode="NumericPages" />
                                        </telerik:RadGrid>
										

										
<asp:SqlDataSource ID="SqlDSInvestigation" runat="server" 
                             ConnectionString="<%$ ConnectionStrings:OnLinePrescriptionConnectionString %>" 
                             DeleteCommand="DELETE FROM [Investigations] WHERE [VisitID] = @VisitID AND [InvestigationCode] = @InvestigationCode" 
                             InsertCommand="INSERT INTO [Investigations] ([VisitID], [InvestigationCode], [VisitDt]) VALUES (@VisitID, @InvestigationCode, CAST(GETDATE() AS DATE))" 
                             
                             SelectCommand="select i.VisitID, i.InvestigationCode,lkp.Investigation FROM [Investigations] i
                             inner join lkp_Investigations as lkp on i.InvestigationCode=lkp.InvestigationCode WHERE ([VisitID] = @VisitID)"
                              
                             UpdateCommand="UPDATE [Investigations] SET [VisitDt] = @VisitDt WHERE [VisitID] = @VisitID AND [InvestigationCode] = @InvestigationCode">
                             
                             <DeleteParameters>
                                 <asp:Parameter Name="VisitID" Type="String" />
                                 <asp:Parameter Name="InvestigationCode" Type="Int16" />
                             </DeleteParameters>
                             
                             <InsertParameters>
                                 <asp:ControlParameter ControlID="txtVisitID" Name="VisitID" PropertyName="Text" Type="String" />
                                 <asp:SessionParameter SessionField="ddInvestigationCode" Name="InvestigationCode" Type="Int32" />
                             </InsertParameters>
                             
                             <SelectParameters>
                                 <asp:ControlParameter ControlID="txtVisitID" Name="VisitID" PropertyName="Text" Type="String" />
                             </SelectParameters>
                             
                             <UpdateParameters>
                                 <asp:Parameter DbType="Date" Name="VisitDt" />
                                 <asp:Parameter Name="VisitID" Type="String" />
                                 <asp:Parameter Name="InvestigationCode" Type="Int16" />
                             </UpdateParameters>
                             
                         </asp:SqlDataSource>
						 

						 
<asp:SqlDataSource ID="SqlDSlkp_Investigations" runat="server"
                         ConnectionString="<%$ ConnectionStrings:OnLinePrescriptionConnectionString %>"
                         SelectCommand="SELECT InvestigationCode,Investigation FROM [lkp_Investigations]"></asp:SqlDataSource>

						 
						 
						 
						 







										